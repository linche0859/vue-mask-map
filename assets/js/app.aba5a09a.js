(function(e){function t(t){for(var n,s,c=t[0],o=t[1],u=t[2],d=0,h=[];d<c.length;d++)s=c[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&h.push(r[s][0]),r[s]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);l&&l(t);while(h.length)h.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,s=1;s<a.length;s++){var o=a[s];0!==r[o]&&(n=!1)}n&&(i.splice(t--,1),e=c(c.s=a[0]))}return e}var n={},r={app:0},i=[];function s(e){return c.p+"assets/js/"+({about:"about"}[e]||e)+"."+{about:"d4fbf69e"}[e]+".js"}function c(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.e=function(e){var t=[],a=r[e];if(0!==a)if(a)t.push(a[2]);else{var n=new Promise((function(t,n){a=r[e]=[t,n]}));t.push(a[2]=n);var i,o=document.createElement("script");o.charset="utf-8",o.timeout=120,c.nc&&o.setAttribute("nonce",c.nc),o.src=s(e);var u=new Error;i=function(t){o.onerror=o.onload=null,clearTimeout(d);var a=r[e];if(0!==a){if(a){var n=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+n+": "+i+")",u.name="ChunkLoadError",u.type=n,u.request=i,a[1](u)}r[e]=void 0}};var d=setTimeout((function(){i({type:"timeout",target:o})}),12e4);o.onerror=o.onload=i,document.head.appendChild(o)}return Promise.all(t)},c.m=e,c.c=n,c.d=function(e,t,a){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(a,n,function(t){return e[t]}.bind(null,n));return a},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/vue-mask-map/",c.oe=function(e){throw console.error(e),e};var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var l=u;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var n=a("85ec"),r=a.n(n);r.a},"365c":function(e,t,a){"use strict";a("d3b7"),a("0fb7"),a("450d");var n=a("f529"),r=a.n(n),i=a("bc3a"),s=a.n(i),c=function(e){r()({message:e,type:"error"})},o=function(e,t){switch(e){case 401:case 403:case 404:c("讀取資料錯誤，請稍後再試");break;default:c(t);break}},u=s.a.create({timeout:12e3});u.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",u.interceptors.request.use((function(e){return e}),(function(e){return Promise.error(e)})),u.interceptors.response.use((function(e){return 200===e.status?Promise.resolve(e.data):Promise.reject(e)}),(function(e){var t=e.response;return t?(o(t.status,t.data.message),Promise.reject(t)):(window.navigator.onLine||c("網路中斷，請重新連結網路"),Promise.reject(e))})),t["a"]=u},"56d7":function(e,t,a){"use strict";a.r(t);a("96cf");var n=a("1da1"),r=(a("0fb7"),a("450d"),a("f529")),i=a.n(r),s=(a("10cb"),a("f3ad")),c=a.n(s),o=(a("6611"),a("e772")),u=a.n(o),d=(a("1f1a"),a("4e4b")),l=a.n(d),h=(a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("2b0e")),m=(a("6cc5"),a("1d84"),a("8243"),a("3ac1"),a("0de5"),a("2573"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("side-bar",{attrs:{markers:e.markers}}),a("div",{staticClass:"container"},[a("router-view",{attrs:{markers:e.markers}})],1)],1)}),f=[],p=a("e11e"),v=a.n(p),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"side-bar"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.sideBarSwitch,expression:"sideBarSwitch"}],attrs:{type:"checkbox",id:"side-bar-switch"},domProps:{checked:Array.isArray(e.sideBarSwitch)?e._i(e.sideBarSwitch,null)>-1:e.sideBarSwitch},on:{change:function(t){var a=e.sideBarSwitch,n=t.target,r=!!n.checked;if(Array.isArray(a)){var i=null,s=e._i(a,i);n.checked?s<0&&(e.sideBarSwitch=a.concat([i])):s>-1&&(e.sideBarSwitch=a.slice(0,s).concat(a.slice(s+1)))}else e.sideBarSwitch=r}}}),a("form",[a("h2",[a("p",[e._v(e._s(e.date.week))]),a("p",[e._v(e._s(e.date.completeDate))])]),a("div",{staticClass:"purchase-info"},[e._v(" 身分證末碼為 "),a("span",[e._v(e._s(e.idCardLastNumber))]),e._v(" 可購買 ")]),a("div",{staticClass:"select-group"},[a("div",{staticClass:"select-item"},[a("el-select",{attrs:{placeholder:"請選擇"},on:{change:e.changeCityHandler},model:{value:e.selected.city,callback:function(t){e.$set(e.selected,"city",t)},expression:"selected.city"}},e._l(e.select.cities,(function(e){return a("el-option",{key:e.CityName,attrs:{label:e.CityName,value:e.CityName}})})),1)],1),a("div",{staticClass:"select-item"},[a("el-select",{attrs:{placeholder:"請選擇"},on:{change:e.changeCountyHandler},model:{value:e.selected.county,callback:function(t){e.$set(e.selected,"county",t)},expression:"selected.county"}},e._l(e.select.counties,(function(e){return a("el-option",{key:e.AreaName,attrs:{label:e.AreaName,value:e.AreaName}})})),1)],1)]),a("el-input",{attrs:{placeholder:"搜尋地址..."},on:{change:e.changeSearchAddressHandler},model:{value:e.input.searchAddress,callback:function(t){e.$set(e.input,"searchAddress",t)},expression:"input.searchAddress"}},[a("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},on:{click:e.getPharmacyListHandler},slot:"suffix"})])],1),a("ul",{staticClass:"nav"},e._l(e.pharmacyList,(function(t){var n=t.properties,r=t.geometry;return a("li",{key:n.id,on:{click:function(t){return e.getDefaultPharmacy(r.coordinates[1],r.coordinates[0])}}},[a("div",[a("h3",[e._v(e._s(n.name))]),a("div",{staticClass:"address"},[e._v(e._s(n.address))]),a("div",{staticClass:"telephone"},[e._v(e._s(n.phone))]),a("div",{staticClass:"info"},[e._v(e._s(n.note))]),a("div",{staticClass:"mask"},[a("a",{class:["adult",{empty:!n.mask_adult}],attrs:{href:"javascript:;"}},[e._v(" 成人口罩 "+e._s(n.mask_adult)+" ")]),a("a",{class:["child",{empty:!n.mask_child}],attrs:{href:"javascript:;"}},[e._v(" 兒童口罩 "+e._s(n.mask_child)+" ")])])])])})),0),e._m(0)])},y=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("label",{staticClass:"drawer",attrs:{for:"side-bar-switch"}},[a("i",{staticClass:"fas fa-angle-right"})])}],b=(a("99af"),a("7db0"),a("c740"),a("4160"),a("d81d"),a("a434"),a("d3b7"),a("159b"),a("5530")),w=a("a417"),k=a("365c"),_=function(){return Object(k["a"])({method:"get",url:w["a"].cityCounty})},C=a("2f62"),P=Object(b["a"])({},Object(C["c"])("pharmacies",["allPharmacies","areaPharmacies"])),A=Object(C["b"])("pharmacies",["getPharmacies","setAreaPharmacies"]);function x(e,t,a){e.eachLayer((function(n){var r=n._latlng.lat,i=n._latlng.lng;r===t&&i===a&&e.zoomToShowLayer(n,(function(){return n.openPopup()}))}))}var j={name:"SideBar",components:{},props:{markers:{type:Object,default:function(){},required:!0}},data:function(){return{userDeviceWidth:768,sideBarSwitch:!1,cityCountyList:[],select:{cities:[],counties:[]},selected:{city:null,county:null},input:{searchAddress:""},pharmacyList:[],date:{week:"",completeDate:""},idCardLastNumber:""}},watch:{sideBarSwitch:function(e){this.changeSideBarPosition(e)}},created:function(){this.getCityCountyHandler()},mounted:function(){this.userDeviceWidth=window.innerWidth>0?window.innerWidth:screen.width;var e=new Date,t=["日","一","二","三","四","五","六"],a=e.getFullYear(),n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,r=e.getDate()<10?"0"+e.getDate():e.getDate();this.date.week="星期".concat(t[e.getDay()]),this.date.completeDate="".concat(a,"-").concat(n,"-").concat(r);var i=0,s=[];if(0===e.getDay())s.push("不限制");else while(i<10){var c=e.getDay()%2;0===i?0===c&&s.push(i):i%2===c&&s.push(i),i++}this.idCardLastNumber=s.toString()},methods:Object(b["a"])(Object(b["a"])({},A),{},{getCityCountyHandler:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_();case 2:a=t.sent,a.forEach((function(e){var t=e.AreaList;-1===t.findIndex((function(e){return"全部區域"===e.AreaName}))&&t.splice(0,0,{AreaName:"全部區域"})})),e.cityCountyList=a,e.select.cities=a.map((function(e){var t=e.CityName,a=e.CityEngName;return{CityName:t,CityEngName:a}})),n=e.select.cities[0].CityName,e.selected.city=n,e.getCountiesHandler(n);case 9:case"end":return t.stop()}}),t)})))()},getCountiesHandler:function(e){var t=this.cityCountyList.find((function(t){return t.CityName===e}));this.select.counties=t.AreaList,this.selected.county=t.AreaList[0].AreaName,this.resetSearchAddressHandler()},resetSearchAddressHandler:function(){this.input.searchAddress="",this.getPharmacyListHandler()},getPharmacyListHandler:function(){this.pharmacyList=this.$store.getters["pharmacies/getAreaPharmacies"]({county:this.selected.city,town:this.selected.county,address:this.input.searchAddress}),this.setAreaPharmacies(this.pharmacyList)},changeCityHandler:function(e){this.getCountiesHandler(e),this.getDefaultPharmacy()},changeCountyHandler:function(){this.resetSearchAddressHandler(),this.getDefaultPharmacy()},changeSearchAddressHandler:function(){this.getPharmacyListHandler(),this.getDefaultPharmacy()},getDefaultPharmacy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.pharmacyList.length?(e||t||(e=this.pharmacyList[0].geometry.coordinates[1],t=this.pharmacyList[0].geometry.coordinates[0]),this.userDeviceWidth<=768&&(this.sideBarSwitch=!0),x(this.markers,e,t)):this.$message({message:"查無資料喔",type:"warning"})},changeSideBarPosition:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=document.querySelector(".side-bar"),a="-300px";t.style.left="".concat(e?a:"0")}})},S=j,L=(a("cdd2"),a("2877")),O=Object(L["a"])(S,g,y,!1,null,"3cb48426",null),E=O.exports,H={name:"App",components:{SideBar:E},data:function(){return{markers:new v.a.MarkerClusterGroup}}},D=H,N=(a("034f"),Object(L["a"])(D,m,f,!1,null,null,null)),B=N.exports,R=a("8c4f"),T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home",attrs:{id:"mapId"}})},M=[];function $(e){v.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"作者 Albert || 設計師 Wendy "}).addTo(e),v.a.control.locate({showPopup:!1}).addTo(e).start()}a("b0c0");function I(e,t,a){e.forEach((function(e){var t=e.geometry,n=e.properties,r=n.mask_adult?"adult":"empty",i=n.mask_child?"child":"empty",s=function(){return n.mask_adult>0&&n.mask_child>0?new v.a.Icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}):0===n.mask_adult&&0===n.mask_child?new v.a.Icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-grey.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}):new v.a.Icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})}();a.addLayer(v.a.marker([t.coordinates[1],t.coordinates[0]],{icon:s}).bindPopup('\n      <div class="marker-card" style="max-width: 200px">\n        <header>\n          <h2 class="h-flex-1">'.concat(n.name,'</h2>\n          <a class="fas fa-location-arrow" href="https://www.google.com.tw/maps/dir//').concat(n.address,'" target="_blank"></a>\n        </header>\n        <section>\n          <div>').concat(n.address,"</div>\n          <div>").concat(n.phone,"</div>\n          <div>").concat(n.note,'</div>\n          <div class="mask">\n            <div class="').concat(r,'">成人口罩 ').concat(n.mask_adult,'</div>\n            <div class="').concat(i,'">兒童口罩 ').concat(n.mask_child,"</div>\n          </div>\n        </section>\n      </div>\n      ")))})),t.addLayer(a)}var z={name:"Home",props:{markers:{type:Object,default:function(){},required:!0}},data:function(){return{map:{},userGeolocation:{latitude:25.04828,longitude:121.51435}}},computed:Object(b["a"])({},P),mounted:function(){var e=navigator.geolocation;if(e){var t=this;navigator.geolocation.getCurrentPosition((function(e){t.userGeolocation.latitude=e.coords.latitude,t.userGeolocation.longitude=e.coords.longitude}))}this.map=v.a.map("mapId",{center:[this.userGeolocation.latitude,this.userGeolocation.longitude],zoom:16}),$(this.map),I(this.allPharmacies,this.map,this.markers)}},G=z,U=(a("67a8"),Object(L["a"])(G,T,M,!1,null,"2d6092c6",null)),W=U.exports;h["default"].use(R["a"]);var q=[{path:"/",name:"Home",component:W},{path:"/about",name:"About",component:function(){return a.e("about").then(a.bind(null,"f820"))}}],F=new R["a"]({mode:"history",base:"/vue-mask-map/",routes:q}),J=F,Y=(a("ac1f"),a("5319"),a("1276"),a("ddb0"),a("bba4")),K=a.n(Y),Q={},V={modules:{}};function X(e,t){if(1===t.length)return e;var a=t.shift();return e.modules[a]=Object(b["a"])({modules:{},namespaced:!0},e.modules[a]),X(e.modules[a],t)}(function(){var e=a("c3e1");e.keys().forEach((function(t){var a=e(t).default||e(t);if(Q[t]!==a){Q[t]=a;var n=t.replace(/^\.\//,"").replace(/\.\w+$/,"").split(/\//).map(K.a),r=X(V,n),i=r.modules;i[n.pop()]=Object(b["a"])({namespaced:!0},a)}}))})();var Z=V.modules;h["default"].use(C["a"]);var ee=new C["a"].Store({strict:!1,state:{},mutations:{},actions:{},modules:Z});a("5377");function te(e){return ae.apply(this,arguments)}function ae(){return ae=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a,n,r,i,s,c,o,u,d,l=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=l.length>1&&void 0!==l[1]?l[1]:{},n=a.modules,r=void 0===n?Z:n,i=a.modulePrefix,s=void 0===i?"":i,c=a.flags,o=void 0===c?{}:c,e.t0=regeneratorRuntime.keys(r);case 2:if((e.t1=e.t0()).done){e.next=15;break}if(u=e.t1.value,d=r[u],!d.actions||!d.actions[t]){e.next=12;break}if(!d.namespaced){e.next=11;break}return e.next=9,ee.dispatch("".concat(s).concat(u,"/").concat(t));case 9:e.next=12;break;case 11:o.dispatchGlobal=!0;case 12:d.modules&&te(t,{modules:d.modules,modulePrefix:s+u+"/",flags:o}),e.next=2;break;case 15:if(s||!o.dispatchGlobal){e.next=18;break}return e.next=18,ee.dispatch(t);case 18:case"end":return e.stop()}}),e)}))),ae.apply(this,arguments)}h["default"].config.productionTip=!1,h["default"].use(l.a),h["default"].use(u.a),h["default"].use(c.a),h["default"].prototype.$message=i.a,Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,te("init");case 2:new h["default"]({router:J,store:ee,render:function(e){return e(B)}}).$mount("#app");case 3:case"end":return e.stop()}}),e)})))()},"59ff":function(e,t,a){},"67a8":function(e,t,a){"use strict";var n=a("59ff"),r=a.n(n);r.a},"85ec":function(e,t,a){},"88ab":function(e,t,a){},a417:function(e,t,a){"use strict";t["a"]={pharmacies:"https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json",cityCounty:"./CityCountyData.json"}},c3e1:function(e,t,a){var n={"./pharmacies.js":"f269"};function r(e){var t=i(e);return a(t)}function i(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=i,e.exports=r,r.id="c3e1"},cdd2:function(e,t,a){"use strict";var n=a("88ab"),r=a.n(n);r.a},f269:function(e,t,a){"use strict";a.r(t),a.d(t,"state",(function(){return d})),a.d(t,"getters",(function(){return l})),a.d(t,"actions",(function(){return h})),a.d(t,"mutations",(function(){return m}));a("4de4"),a("d3b7"),a("4d63"),a("ac1f"),a("25f0"),a("466d"),a("0fb7"),a("450d");var n=a("f529"),r=a.n(n),i=(a("be4f"),a("896a")),s=a.n(i),c=a("a417"),o=a("365c"),u=function(){return Object(o["a"])({method:"get",url:c["a"].pharmacies})},d={pharmacyList:[],areaPharmacies:[]},l={getAreaPharmacies:function(e){return function(t){var a=t.county,n=void 0===a?"":a,r=t.town,i=void 0===r?"":r,s=t.address,c=void 0===s?"":s,o=null;o=c||("全部區域"===i?n:n+i);var u=new RegExp(o,"gi");return e.pharmacyList.filter((function(e){return e.properties.address.match(u)}))}},allPharmacies:function(e){return e.pharmacyList},areaPharmacies:function(e){return e.areaPharmacies}},h={init:function(e){var t=e.dispatch;return new Promise((function(e){t("getPharmacies").then((function(){return e()}))}))},getPharmacies:function(e){var t=e.commit;return new Promise((function(e){var a=s.a.service({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});u().then((function(e){a.close(),t("SET_PHARMACIES",e.features)})).catch((function(){r()({message:"讀取資料錯誤，請稍後再試",type:"error"})})).finally((function(){return e()}))}))},setAreaPharmacies:function(e,t){var a=e.commit;a("SET_AREA_PHARMACIES",t)}},m={SET_PHARMACIES:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.pharmacyList=t},SET_AREA_PHARMACIES:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.areaPharmacies=t}}}});
//# sourceMappingURL=app.aba5a09a.js.map